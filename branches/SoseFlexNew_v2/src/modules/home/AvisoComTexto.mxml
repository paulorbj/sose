<?xml version="1.0" encoding="utf-8"?>
<home:AvisoContainer 
	xmlns:fx="http://ns.adobe.com/mxml/2009" 
	width="100%" 
	height="100%" 
	creationComplete="init()" 
	xmlns:components="components.*"			   
	xmlns:s="library://ns.adobe.com/flex/spark" 
	tituloDoAviso="Reparos por condição" 
	creationPolicy="all" 
	horizontalScrollPolicy="off" 
	verticalScrollPolicy="off"
	xmlns:mx="library://ns.adobe.com/flex/mx" 
	xmlns:home="modules.home.*" 
	xmlns:combos="components.combos.*" 
	xmlns:textInput="components.textInput.*" >
	
	<fx:Declarations>
		<mx:RemoteObject id="avisoService" destination="avisoService" endpoint="{resourceManager.getString('ConfigurationResource','amf')}">			
			<mx:method name="salvarAviso"      
					   fault="onBuscarInfoGraficoReparoFinalizadoPorCondicaoFault(event)" 
					   result="onBuscarInfoGraficoReparoFinalizadoPorCondicaoResult(event)"
					   />
		</mx:RemoteObject>
	</fx:Declarations>
	
	
	<fx:Script>
		<![CDATA[
			import entities.administrativo.parceiros.Pessoa;
			import entities.componentes.Aviso;
			
			import flashx.textLayout.conversion.ConversionType;
			import flashx.textLayout.conversion.TextConverter;
			
			import mx.collections.ArrayCollection;
			import mx.managers.CursorManager;
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;
			
			import spark.utils.TextFlowUtil;
			
			[Bindable]
			public var dadosGrafico:ArrayCollection;
			
			[bindable]
			private var mwidth:Number;
			
			[bindable]
			private var mheight:Number;
			
			[bindable]
			public var objetoAviso:Aviso;
			
			private function CapabilitiesMax():void
			{
				mwidth = 0.3*Capabilities.screenResolutionX;
				mheight = 0.3*Capabilities.screenResolutionY;
			}
			
			private function init():void
			{
				//graficoService.buscarInfoGraficoReparoFinalizadoPorCondicao(null,null,null,null,null,null);
				//textoTitulo.inputText = tituloDoAviso;
				//super.cancelar = cancelar;
			}
			
			protected function aplicar(event:MouseEvent):void
			{
				//graficoService.buscarInfoGraficoReparoFinalizadoPorCondicao(dataDe.inputDate,dataAte.inputDate,cliente.clienteSelecionado,laboratorio.laboratorioSelecionado,tecnico.usuarioSelecionado, unidade.unidadeSelecionado);
			}
			
			override public function fechar():void
			{
				
				super.mudarParaVisualizacao();
				tituloDoAviso = textoTitulo.inputText;
				textoRich.textFlow = TextConverter.importToFlow(myRTE.htmlText, TextConverter.TEXT_FIELD_HTML_FORMAT);
				avisoService.salvarAviso()
			}
			
			override public function abrirConfig():void
			{
				
				super.mudarParaConfiguracao();
				textoTitulo.inputText = objetoAviso.titulo;
				myRTE.htmlText = TextConverter.export(textoRich.textFlow, TextConverter.TEXT_FIELD_HTML_FORMAT, ConversionType.STRING_TYPE) as String;
			}
			
			
			protected function limpar(event:MouseEvent=null):void
			{

			}
			
			private function onBuscarInfoGraficoReparoFinalizadoPorCondicaoResult(event:ResultEvent = null):void
			{
				CursorManager.removeAllCursors(); 
				dadosGrafico = event.result as ArrayCollection;
			}
			
			private function onBuscarInfoGraficoReparoFinalizadoPorCondicaoFault(event:FaultEvent = null):void
			{
				CursorManager.removeAllCursors();
				trace("[onBuscarInfoGraficoReparoFinalizadoPorCondicaoFault] [" +	event.fault.faultCode + "] " + event.fault.faultString + " (" +	event.fault.faultDetail + ")");		
			}
			
		]]>
	</fx:Script>
		
	<home:visualizacao>
<!--		<mx:VBox width="100%" height="100%" >-->
			<s:Scroller width="100%"  height="100%" focusEnabled="false">
				<s:Group clipAndEnableScrolling="true"  >
					<s:RichText text="Texto do aviso" id="textoRich" width="100%" height="100%" />
						
					
				</s:Group>
			</s:Scroller>
			
			
			
			
			
			
<!--		</mx:VBox>-->
	</home:visualizacao>
	
	<home:configuracao>
		<mx:VBox width="100%" height="100%" paddingTop="5" paddingRight="5" paddingLeft="5" horizontalScrollPolicy="off" verticalScrollPolicy="off">
			<mx:HBox width="100%" verticalAlign="middle">
				<s:Label text="Titulo do quadro" />
				<textInput:TextInput id="textoTitulo" width="100%" />
			</mx:HBox>
			
			<mx:HBox bottom="5" width="100%" height="100%">
				<mx:RichTextEditor id="myRTE" text="{objetoAviso.mensagem}" height="100%" width="100%" />
			</mx:HBox>
		</mx:VBox>

	</home:configuracao>
	
</home:AvisoContainer>
